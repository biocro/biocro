<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/AuxBioCro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_aux_bio_cro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AuxBioCro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">c4photo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">BioCro.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for AuxBioCro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_aux_bio_cro_8c__incl.png" border="0" usemap="#src_2_aux_bio_cro_8c" alt=""/></div>
<map name="src_2_aux_bio_cro_8c" id="src_2_aux_bio_cro_8c">
<area shape="rect" id="node9" href="c4photo_8h.html" title="c4photo.h" alt="" coords="283,83,360,112"/><area shape="rect" id="node11" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="384,83,480,112"/><area shape="rect" id="node13" href="_bio_cro_8h.html" title="BioCro.h" alt="" coords="504,83,576,112"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a46827eb56108821fe82228553f535293"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a> (double lat, int DOY, int td)</td></tr>
<tr class="memitem:acb415c4c261f9fc0140240ad46007c87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a> (double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</td></tr>
<tr class="memitem:a43b0d68a959084dc4f4dc099c8901107"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a> (double WindSpeed, double LAI, int nlayers)</td></tr>
<tr class="memitem:a247148ac54cf7d8c851326de6093b71e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a> (double RH, int nlayers)</td></tr>
<tr class="memitem:aa65c89edaec63830e4dd568a89d12fa2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a> (double LeafN, double LAI, int nlayers, double kpLN)</td></tr>
<tr class="memitem:aef4a29370ba3b33794837905d82f3b86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a> (double Temp)</td></tr>
<tr class="memitem:abea4623ebab0e4ea7d9be5af1fd80344"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a> (double Temp)</td></tr>
<tr class="memitem:abd35797ea11e52f0c527d40a9c1c0b7d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a> (double Temp)</td></tr>
<tr class="memitem:a2b62fa0d37af87f9af219e7b0d56f34d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a> (double Temp)</td></tr>
<tr class="memitem:a05f213f4cb25cf49735180ff3b883107"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_e_t___str.html">ET_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a> (double Rad, double Itot, double Airtemperature, double RH, double WindSpeed, double LeafAreaIndex, double CanopyHeight, double StomataWS, int ws, double vmax2, double alpha2, double kparm, double theta, double beta, double Rd2, double b02, double b12, double upperT, double lowerT, double Catm)</td></tr>
<tr class="memitem:ac96acf762dd39d5ff20d71788b0ca566"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a> (double LAI, double k, double AirTemp, double IRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</td></tr>
<tr class="memitem:ad67c5b654f4bceb23717a84244291ea0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="memitem:a8dfc137af141b612fc3cde9b49b0fc5f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structws__str.html">ws_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a> (double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, int soiltype, int wsFun)</td></tr>
<tr class="memitem:a5537e2a57efaaf41b401666bb9e22062"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a> (double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct <a class="el" href="structsoil_text__str.html">soilText_str</a> soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf)</td></tr>
<tr class="memitem:aeb35169469ef33705592a28743d105bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a> (double comp, double mrc, double temp)</td></tr>
<tr class="memitem:a4dc70ed4086616dabcbc7565d36d247b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdbp__str.html">dbp_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a> (double coefs[25], double TherPrds[6], double TherTime)</td></tr>
<tr class="memitem:a668682ce55f6888ab3ec44a7d7a48d07"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structseq_r_d__str.html">seqRD_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a> (double to, int lengthOut)</td></tr>
<tr class="memitem:a76d97071934ef506589d0ca8114d3647"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structrd__str.html">rd_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a> (int layer, double rootDepth, double *depthsp, double rfl)</td></tr>
<tr class="memitem:a72f93049960e067cda6e7291ff1ff21a"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsoil_text__str.html">soilText_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a> (int soiltype)</td></tr>
<tr class="memitem:a7df839d343fafd0d7ef9e81fe7ac73d9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_aux_bio_cro_8c.html#a7df839d343fafd0d7ef9e81fe7ac73d9">cropcent_dbp</a> (double coefs[25], double TherPrds[6], double TherTime, struct <a class="el" href="structcrop__phenology.html">crop_phenology</a> *cropdbp)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="ad67c5b654f4bceb23717a84244291ea0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L539">539</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET, tmp6_ET;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc4;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc42;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">        <span class="keywordtype">double</span> IDir, IDiff, Itot, rh, WS;</div>
<div class="line">        <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line">        <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line">        <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> vmax1, leafN_lay;</div>
<div class="line">        <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff,GAssIdir,GAssIdiff;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> CanopyA, CanopyT,GCanopyA;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Assimilation */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line">        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"></div>
<div class="line">        Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line">        Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line">        cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line">    </div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh, kd, chil, heightf);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* results from multilayer model */</span></div>
<div class="line">        LAIc = LAI / nlayers;</div>
<div class="line">        <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(leafN, LAI, nlayers, kpLN);</div>
<div class="line">        <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line">        CanopyA=0.0;</div>
<div class="line">        GCanopyA=0.0;</div>
<div class="line">        CanopyT=0.0;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line">                <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line">                        vmax1 = Vmax;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        vmax1 = leafN_lay * lnb1 + lnb0;</div>
<div class="line">               <span class="comment">/* For now alpha is not affected by leaf nitrogen */</span></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line">                Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"></div>
<div class="line">                rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line">                WS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line">                pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line">                CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line">                Leafsun = LAIc * pLeafsun;</div>
<div class="line">                tmp5_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line">                TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line">                tmpc4 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDir,TempIdir,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line">                AssIdir = tmpc4.Assim;</div>
<div class="line">    GAssIdir =tmpc4.GrossAssim;</div>
<div class="line"></div>
<div class="line">                IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line">                pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line">                Leafshade = LAIc * pLeafshade;</div>
<div class="line">                tmp6_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line">                TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line">                tmpc42 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDiff,TempIdiff,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line">                AssIdiff = tmpc42.Assim;</div>
<div class="line">    GAssIdiff = tmpc42.GrossAssim;</div>
<div class="line">                CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line">    GCanopyA += Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line"><span class="comment">// I am evaluating CanopyT using Penman Method because it gives realistic results</span></div>
<div class="line"><span class="comment">// IN future canopyT needs to be fixed</span></div>
<div class="line"><span class="comment">//                CanopyT += Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR;</span></div>
<div class="line">                CanopyT += Leafsun * tmp5_ET.EPenman + Leafshade * tmp6_ET.EPenman;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><span class="comment">          ## Need to convert to </span></div>
<div class="line"><span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><span class="comment">   mols (instead of micro) */</span></div>
<div class="line">        ans.Assim = cf * CanopyA ;</div>
<div class="line">        ans.Trans = cf2 * CanopyT; </div>
<div class="line">        ans.GrossAssim=cf*GCanopyA;</div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a7df839d343fafd0d7ef9e81fe7ac73d9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cropcent_dbp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>coefs</em>[25], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherPrds</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structcrop__phenology.html">crop_phenology</a> *&#160;</td>
          <td class="paramname"><em>cropdbp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1338">1338</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">     {     </div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> tmp;</div>
<div class="line">        <span class="comment">// call old biomass partiitoning coefficient function</span></div>
<div class="line">        tmp =<a class="code" href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a>(coefs, TherPrds, TherTime);</div>
<div class="line">        <span class="comment">//assing it to the relevant sub structure of new cropdbp, to be retirned back to the main program</span></div>
<div class="line">        cropdbp-&gt;<a class="code" href="structcrop__phenology.html#ac9b57b8347b6359c71fd242338ab874f">DBP</a>=tmp;</div>
<div class="line">       <span class="comment">// Here I must define what are CN ratios of different plant components under excess N fertilization</span></div>
<div class="line">       </div>
<div class="line">       </div>
<div class="line">       <span class="comment">// I can leave it empty for now</span></div>
<div class="line">       <span class="keywordflow">return</span>;</div>
<div class="line">     }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a05f213f4cb25cf49735180ff3b883107"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_e_t___str.html">ET_Str</a> EvapoTrans </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Itot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Airtemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafAreaIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CanopyHeight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmax2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b02</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L208">208</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="comment">/* creating the structure to return */</span></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc4;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> LeafWidth = 0.04;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> kappa = 0.41;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> WindSpeedHeight = 5;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> dCoef = 0.77;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> tau = 0.2;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> ZetaCoef = 0.026;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> ZetaMCoef = 0.13;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> LeafReflectance = 0.2;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SpecificHeat = 1010;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> Tair, WindSpeedTopCanopy;</div>
<div class="line">        <span class="keywordtype">double</span> DdryA, LHV, SlopeFS, SWVC;</div>
<div class="line">        <span class="keywordtype">double</span> LayerRelativeHumidity, LayerWindSpeed, totalradiation;</div>
<div class="line">        <span class="keywordtype">double</span> LayerConductance, DeltaPVa, PsycParam, ga;</div>
<div class="line">        <span class="keywordtype">double</span> BoundaryLayerThickness, DiffCoef,LeafboundaryLayer;</div>
<div class="line">        <span class="keywordtype">double</span> d, Zeta, Zetam, ga0, ga1, ga2; </div>
<div class="line">        <span class="keywordtype">double</span> Ja, Deltat;</div>
<div class="line">        <span class="keywordtype">double</span> PhiN;</div>
<div class="line">        <span class="keywordtype">double</span> TopValue, BottomValue;</div>
<div class="line">        <span class="keywordtype">double</span> EPen, TransR,EPries; </div>
<div class="line">        <span class="keywordtype">double</span> OldDeltaT, rlc, ChangeInLeafTemp; </div>
<div class="line">        <span class="keywordtype">int</span> Counter;</div>
<div class="line"></div>
<div class="line">        WindSpeedTopCanopy = WindSpeed;</div>
<div class="line">        Tair = Airtemperature;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(CanopyHeight &lt; 0.1)</div>
<div class="line">                CanopyHeight = 0.1; </div>
<div class="line"></div>
<div class="line">        DdryA = <a class="code" href="_aux_bio_cro_8c.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a>(Tair) ;</div>
<div class="line">        LHV = <a class="code" href="_aux_bio_cro_8c.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a>(Tair) * 1e6 ; </div>
<div class="line">        <span class="comment">/* Here LHV is given in MJ kg-1 and this needs to be converted</span></div>
<div class="line"><span class="comment">           to Joules kg-1  */</span></div>
<div class="line">        SlopeFS = <a class="code" href="_aux_bio_cro_8c.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a>(Tair) * 1e-3;</div>
<div class="line">        SWVC = <a class="code" href="_aux_bio_cro_8c.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a>(Tair) * 1e-3;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* FIRST CALCULATIONS*/</span></div>
<div class="line"></div>
<div class="line">        Zeta = ZetaCoef * CanopyHeight;</div>
<div class="line">        Zetam = ZetaMCoef * CanopyHeight;</div>
<div class="line">        d = dCoef * CanopyHeight;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Relative Humidity is giving me a headache */</span></div>
<div class="line">        <span class="comment">/* RH2 = RH * 1e2; A high value of RH makes the </span></div>
<div class="line"><span class="comment">           difference of temperature between the leaf and the air huge.</span></div>
<div class="line"><span class="comment">           This is what is causing the large difference in DeltaT at the </span></div>
<div class="line"><span class="comment">           bottom of the canopy. I think it is very likely.  */</span></div>
<div class="line">        LayerRelativeHumidity = RH * 100;</div>
<div class="line">        <span class="keywordflow">if</span>(LayerRelativeHumidity &gt; 100) </div>
<div class="line">                error(<span class="stringliteral">&quot;LayerRelativehumidity &gt; 100&quot;</span>); </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(WindSpeed &lt; 0.5) WindSpeed = 0.5;</div>
<div class="line"></div>
<div class="line">        LayerWindSpeed = WindSpeed;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*&#39; Convert light assuming 1 Âµmol PAR photons = 0.235 J/s Watts*/</span></div>
<div class="line">        totalradiation = Itot * 0.235;</div>
<div class="line"></div>
<div class="line">        tmpc4 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(Itot,Airtemperature,RH,vmax2,alpha2,kparm,theta,beta,Rd2,b02,b12,StomataWS, Catm, ws,upperT,lowerT); </div>
<div class="line">        LayerConductance = tmpc4.Gs;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Convert mmoles/m2/s to moles/m2/s</span></div>
<div class="line"><span class="comment">           LayerConductance = LayerConductance * 1e-3</span></div>
<div class="line"><span class="comment">           Convert moles/m2/s to mm/s</span></div>
<div class="line"><span class="comment">           LayerConductance = LayerConductance * 24.39</span></div>
<div class="line"><span class="comment">           Convert mm/s to m/s</span></div>
<div class="line"><span class="comment">           LayerConductance = LayerConductance * 1e-3 */</span></div>
<div class="line"></div>
<div class="line">        LayerConductance = LayerConductance * 1e-6 * 24.39;  </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Thornley and Johnson use m s^-1 on page 418 */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* prevent errors due to extremely low Layer conductance */</span></div>
<div class="line">        <span class="keywordflow">if</span>(LayerConductance &lt;=0)</div>
<div class="line">                LayerConductance = 0.01;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(SWVC &lt; 0)</div>
<div class="line">                error(<span class="stringliteral">&quot;SWVC &lt; 0&quot;</span>);</div>
<div class="line">        <span class="comment">/* Now RHprof returns relative humidity in the 0-1 range */</span></div>
<div class="line">        DeltaPVa = SWVC * (1 - LayerRelativeHumidity / 100);</div>
<div class="line"></div>
<div class="line">        PsycParam =(DdryA * SpecificHeat) / LHV;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Ja = (2 * totalradiation * ((1 - LeafReflectance - tau) / (1 - tau))) * LeafAreaIndex; */</span></div>
<div class="line">        <span class="comment">/* It seems that it is not correct to multiply by the leaf area index. Thornley</span></div>
<div class="line"><span class="comment">           and johnson pg. 400 suggest using (1-exp(-k*LAI) but note that for a full canopy</span></div>
<div class="line"><span class="comment">           this is 1. so I&#39;m using 1 as an approximation. */</span></div>
<div class="line">        Ja = (2 * totalradiation * ((1 - LeafReflectance - tau) / (1 - tau)));</div>
<div class="line">        <span class="comment">/* Calculation of ga */</span></div>
<div class="line">        <span class="comment">/* According to thornley and Johnson pg. 416 */</span></div>
<div class="line">        ga0 = pow(kappa,2) * LayerWindSpeed;</div>
<div class="line">        ga1 = log((WindSpeedHeight + Zeta - d)/Zeta);</div>
<div class="line">        ga2 = log((WindSpeedHeight + Zetam - d)/Zetam);</div>
<div class="line">        ga = ga0/(ga1*ga2);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  Rprintf(&quot;ga: %.5f \n&quot;, ga); */</span></div>
<div class="line">        <span class="keywordflow">if</span>(ga &lt; 0)</div>
<div class="line">                error(<span class="stringliteral">&quot;ga is less than zero&quot;</span>);</div>
<div class="line"></div>
<div class="line">        DiffCoef = (2.126 * 1e-5) + ((1.48 * 1e-7) * Airtemperature);</div>
<div class="line">        BoundaryLayerThickness = 0.004 * sqrt(LeafWidth / LayerWindSpeed);</div>
<div class="line">        LeafboundaryLayer = DiffCoef / BoundaryLayerThickness;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Temperature of the leaf according to Campbell and Norman (1998) Chp 4.*/</span></div>
<div class="line">        <span class="comment">/* This version is non-iterative and an approximation*/</span></div>
<div class="line">        <span class="comment">/* Stefan-Boltzmann law: B = sigma * T^4. where sigma is the Boltzmann</span></div>
<div class="line"><span class="comment">           constant: 5.67 * 1e-8 W m^-2 K^-4. */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* From Table A.3 in the book we know that*/</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  rlc = (4 * (5.67*1e-8) * pow(273 + Airtemperature, 3) * Deltat) * LeafAreaIndex;   */</span></div>
<div class="line">        <span class="comment">/*  PhiN = Ja - rlc; */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  dd = 0.72 * LeafWidth; */</span></div>
<div class="line">        <span class="comment">/*  gHa = 1.4 * 0.135 * sqrt(LayerWindSpeed * 0.72 * LeafWidth);  */</span></div>
<div class="line">        <span class="comment">/*  gva = 1.4 * 0.147 * sqrt(LayerWindSpeed * 0.72 * LeafWidth);  */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  TopValue = Ja - (SWVC/7.28) * 5.67*1e-8 * pow(Airtemperature + 273.15,4) - LHV * LayerConductance * 1e-3 * DeltaPVa / 101.3; */</span></div>
<div class="line">        <span class="comment">/* Here I divide SWVC by 7.28 to approximately change from g/m3 to kPa */</span></div>
<div class="line">        <span class="comment">/* I&#39;m also multiplying Layer conductance by 1e-3 since it should be in mol m^-2 s^-1 */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  BottomValue = SpecificHeat * gHr + LHV * SlopeFS * LayerConductance * 1e-3;  */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  Deltat = Airtemperature + TopValue/BottomValue; */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  PhiN = TopValue; */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* This is the original from WIMOVAC*/</span></div>
<div class="line">        Deltat = 0.01;</div>
<div class="line">        ChangeInLeafTemp = 10;</div>
<div class="line"></div>
<div class="line">        Counter = 0;</div>
<div class="line">        <span class="keywordflow">while</span>( (ChangeInLeafTemp &gt; 0.5) &amp;&amp; (Counter &lt;= 10))</div>
<div class="line">        {</div>
<div class="line">                OldDeltaT = Deltat;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/*         rlc = (4 * (5.67*1e-8) * pow(273 + Airtemperature, 3) * Deltat) * LeafAreaIndex;   */</span></div>
<div class="line">                rlc = (4 * (5.67*1e-8) * pow(273 + Airtemperature, 3) * Deltat);  </div>
<div class="line"></div>
<div class="line">                PhiN = (Ja - rlc);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                TopValue = PhiN * (1 / ga + 1 / LayerConductance) - LHV * DeltaPVa;</div>
<div class="line">                BottomValue = LHV * (SlopeFS + PsycParam * (1 + ga / LayerConductance));</div>
<div class="line">                Deltat = TopValue / BottomValue;</div>
<div class="line">                <span class="keywordflow">if</span>(Deltat &gt; 5)  Deltat = 5;</div>
<div class="line">                <span class="keywordflow">if</span>(Deltat &lt; -5) Deltat = -5;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                ChangeInLeafTemp = OldDeltaT - Deltat;</div>
<div class="line">                <span class="keywordflow">if</span>(ChangeInLeafTemp &lt;0)</div>
<div class="line">                        ChangeInLeafTemp = -ChangeInLeafTemp;</div>
<div class="line">                Counter++;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(PhiN &lt; 0)</div>
<div class="line">                PhiN = 0;</div>
<div class="line"></div>
<div class="line">        TransR = (SlopeFS * PhiN + (LHV * PsycParam * ga * DeltaPVa)) / (LHV * (SlopeFS + PsycParam * (1 + ga / LayerConductance)));</div>
<div class="line"></div>
<div class="line">        EPries = 1.26 * ((SlopeFS * PhiN) / (LHV * (SlopeFS + PsycParam)));</div>
<div class="line"></div>
<div class="line">        EPen = (((SlopeFS * PhiN) + LHV * PsycParam * ga * DeltaPVa)) / (LHV * (SlopeFS + PsycParam));</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* This values need to be converted from Kg/m2/s to</span></div>
<div class="line"><span class="comment">           mmol H20 /m2/s according to S Humphries */</span></div>
<div class="line">        <span class="comment">/*res[1,1] = EPen * 10e6 / 18;*/</span></div>
<div class="line">        <span class="comment">/*res[1,2] = EPries * 10e6 / 18;*/</span></div>
<div class="line">        <span class="comment">/* 1e3 - kgrams to grams  */</span></div>
<div class="line">        <span class="comment">/* 1e3 - mols to mmols */</span></div>
<div class="line">        <span class="comment">/*  res[0] = ((TransR * 1e3) / 18) * 1e3 ; */</span></div>
<div class="line">        <span class="comment">/*  res[1] = Deltat; */</span></div>
<div class="line">        <span class="comment">/*  res[2] = LayerConductance; */</span></div>
<div class="line">        <span class="comment">/* Let us return the structure now */</span></div>
<div class="line"></div>
<div class="line">        tmp.TransR = TransR * 1e6 / 18; </div>
<div class="line">        tmp.EPenman = EPen * 1e6 / 18; </div>
<div class="line">        tmp.EPriestly = EPries * 1e6 / 18; </div>
<div class="line">        tmp.Deltat = Deltat;</div>
<div class="line">        tmp.LayerCond = LayerConductance * 1e6 * (1/24.39);   </div>
<div class="line">        <span class="comment">/*    tmp.LayerCond = RH2;   */</span></div>
<div class="line">        <span class="comment">/*   tmp.LayerCond = 0.7; */</span></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a46827eb56108821fe82228553f535293"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lightME </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>td</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L26">26</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[];</div>
<div class="line">        <span class="keywordtype">double</span> *ip1;</div>
<div class="line">        ip1 = &amp;tmp1[0];</div>
<div class="line">        <span class="keywordtype">double</span> omega, delta0, delta, deltaR;</div>
<div class="line">        <span class="keywordtype">double</span> tf, SSin, CCos, PPo;</div>
<div class="line">        <span class="keywordtype">double</span> CosZenithAngle, CosHour;</div>
<div class="line">        <span class="keywordtype">double</span> CosHourDeg;</div>
<div class="line">        <span class="keywordtype">double</span> Idir, Idiff, propIdir, propIdiff;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> DTR = <a class="code" href="denitrify_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> tsn = 12.0;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = 0.85;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SolarConstant = 2650;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> atmP = 1e5;</div>
<div class="line"></div>
<div class="line">        omega = lat * DTR;</div>
<div class="line">        delta0 = 360.0 * ((DOY + 10)/365.0);</div>
<div class="line">        delta = -23.5 * cos(delta0*DTR);</div>
<div class="line">        deltaR = delta * DTR;</div>
<div class="line"></div>
<div class="line">        tf = (15.0*(td - tsn))*DTR;</div>
<div class="line">        SSin = sin(deltaR) * sin(omega);</div>
<div class="line">        CCos = cos(deltaR) * cos(omega);</div>
<div class="line"></div>
<div class="line">        CosZenithAngle = SSin + CCos * cos(tf);</div>
<div class="line">        <span class="keywordflow">if</span>(CosZenithAngle &lt; pow(10,-10))</div>
<div class="line">                CosZenithAngle = pow(10,-10);</div>
<div class="line"></div>
<div class="line">        CosHour = -tan(omega) * tan(deltaR);</div>
<div class="line">        CosHourDeg = (1/DTR)*CosHour;</div>
<div class="line">        <span class="keywordflow">if</span>(CosHourDeg &lt; -57)</div>
<div class="line">                CosHour = -0.994;</div>
<div class="line"></div>
<div class="line">        PPo = 1e5 / atmP;</div>
<div class="line">        Idir = SolarConstant * (pow(alpha,(PPo/CosZenithAngle)));</div>
<div class="line">        Idiff = 0.3 * SolarConstant *(1 - pow(alpha,(PPo/CosZenithAngle))) * CosZenithAngle ;</div>
<div class="line"></div>
<div class="line">        propIdir = Idir / (Idir + Idiff);</div>
<div class="line">        propIdiff = Idiff / (Idir + Idiff);</div>
<div class="line"></div>
<div class="line">        *ip1 = propIdir;</div>
<div class="line">        *(ip1+1) = propIdiff;</div>
<div class="line">        *(ip1+2) = CosZenithAngle;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa65c89edaec63830e4dd568a89d12fa2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LNprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L163">163</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> leafNla, LI, CumLAI;</div>
<div class="line"></div>
<div class="line">        LI  = LAI / nlayers;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                CumLAI = LI * (i + 1);</div>
<div class="line">                leafNla = LeafN * exp(-kpLN * (CumLAI-LI));</div>
<div class="line">                <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>++] = leafNla;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeb35169469ef33705592a28743d105bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double resp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1021">1021</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                 {</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> ans;</div>
<div class="line"></div>
<div class="line">        ans = comp *  (1 - (mrc * pow(2,(temp/10.0))));</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(ans &lt;0) ans = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a247148ac54cf7d8c851326de6093b71e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RHprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L144">144</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> kh, hsla, j;</div>
<div class="line"></div>
<div class="line">        kh = 1 - RH;</div>
<div class="line">        <span class="comment">/* kh = 0.2; */</span></div>
<div class="line">        <span class="comment">/*kh = log(1/RH);*/</span></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                j = i + 1;</div>
<div class="line">                hsla = RH * exp(kh * (j/nlayers));</div>
<div class="line"><span class="comment">//              /*hsla = RH * exp(-kh * (j/nlayers));  /*new simpler version from Joe Iverson*/</span></div>
<div class="line">                <span class="keywordflow">if</span>(hsla &gt; 1) hsla = 0.99; </div>
<div class="line">                <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>++] = hsla;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* It should return values in the 0-1 range */</span></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a76d97071934ef506589d0ca8114d3647"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structrd__str.html">rd_str</a> rootDist </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootDepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depthsp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rfl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1120">1120</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrd__str.html">rd_str</a> tmp;  </div>
<div class="line">        <span class="keywordtype">int</span> i, j, k;</div>
<div class="line">        <span class="keywordtype">double</span> layerDepth = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> CumLayerDepth = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> CumRootDist = 1.0;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a>[layer];</div>
<div class="line">        <span class="keywordtype">double</span> ca = 0.0, a = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;layer;i++){</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line">                        layerDepth = depthsp[1];</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        layerDepth = depthsp[i] - depthsp[i-1];</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                CumLayerDepth += layerDepth;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(rootDepth &gt; CumLayerDepth){</div>
<div class="line">                        CumRootDist++;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(j=0;j&lt;layer;j++){</div>
<div class="line">                <span class="keywordflow">if</span>(j &lt; CumRootDist){ </div>
<div class="line">                        a = dpois(j+1,CumRootDist*rfl,0);</div>
<div class="line">                        rootDist[j] = a;</div>
<div class="line">                        ca += a;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        rootDist[j] = 0;</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(k=0;k&lt;layer;k++){</div>
<div class="line">                tmp.rootDist[k] = rootDist[k] / ca; </div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4dc70ed4086616dabcbc7565d36d247b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdbp__str.html">dbp_str</a> sel_dbp_coef </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>coefs</em>[25], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherPrds</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1036">1036</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                  {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> tmp;</div>
<div class="line"></div>
<div class="line">        tmp.<a class="code" href="structdbp__str.html#ac99cccaa39474eb44da7927824bf1590">kLeaf</a> = 0.0;</div>
<div class="line">        tmp.kStem = 0.0;</div>
<div class="line">        tmp.kRoot = 0.0;</div>
<div class="line">        tmp.kRhiz = 0.0;</div>
<div class="line">        tmp.kGrain = 0.0; <span class="comment">/* kGrain is always zero except for the last thermal period */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(TherTime &lt; TherPrds[0])</div>
<div class="line">        {</div>
<div class="line">                tmp.kStem = coefs[0];</div>
<div class="line">                tmp.kLeaf = coefs[1];</div>
<div class="line">                tmp.kRoot = coefs[2];</div>
<div class="line">                tmp.kRhiz = coefs[3];</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>( TherTime &lt; TherPrds[1] )</div>
<div class="line">                {</div>
<div class="line">                        tmp.kStem = coefs[4];</div>
<div class="line">                        tmp.kLeaf = coefs[5];</div>
<div class="line">                        tmp.kRoot = coefs[6];</div>
<div class="line">                        tmp.kRhiz = coefs[7];</div>
<div class="line"></div>
<div class="line">                } <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keywordflow">if</span>( TherTime &lt; TherPrds[2])</div>
<div class="line">                        {</div>
<div class="line">                                tmp.kStem = coefs[8];</div>
<div class="line">                                tmp.kLeaf = coefs[9];</div>
<div class="line">                                tmp.kRoot = coefs[10];</div>
<div class="line">                                tmp.kRhiz = coefs[11];</div>
<div class="line"></div>
<div class="line">                        } <span class="keywordflow">else</span></div>
<div class="line">                                <span class="keywordflow">if</span>(TherTime &lt; TherPrds[3])</div>
<div class="line">                                {</div>
<div class="line">                                        tmp.kStem = coefs[12];</div>
<div class="line">                                        tmp.kLeaf = coefs[13];</div>
<div class="line">                                        tmp.kRoot = coefs[14];</div>
<div class="line">                                        tmp.kRhiz = coefs[15];</div>
<div class="line"></div>
<div class="line">                                } <span class="keywordflow">else</span></div>
<div class="line">                                        <span class="keywordflow">if</span>(TherTime &lt; TherPrds[4])</div>
<div class="line">                                        {</div>
<div class="line">                                                tmp.kStem = coefs[16];</div>
<div class="line">                                                tmp.kLeaf = coefs[17];</div>
<div class="line">                                                tmp.kRoot = coefs[18];</div>
<div class="line">                                                tmp.kRhiz = coefs[19];</div>
<div class="line"></div>
<div class="line">                                        } <span class="keywordflow">else</span>{</div>
<div class="line">                                                </div>
<div class="line">                                                        tmp.kStem = coefs[20];</div>
<div class="line">                                                        tmp.kLeaf = coefs[21];</div>
<div class="line">                                                        tmp.kRoot = coefs[22];</div>
<div class="line">                                                        tmp.kRhiz = coefs[23];</div>
<div class="line">                                                        tmp.kGrain = coefs[24];</div>
<div class="line">                                                </div>
<div class="line">                                                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a668682ce55f6888ab3ec44a7d7a48d07"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structseq_r_d__str.html">seqRD_str</a> seqRootDepth </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lengthOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1100">1100</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                       {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structseq_r_d__str.html">seqRD_str</a> tmp;</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> by;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* This is because in this case from is always zero */</span></div>
<div class="line">        by = to / lengthOut;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;=lengthOut;i++){</div>
<div class="line"></div>
<div class="line">                tmp.<a class="code" href="structseq_r_d__str.html#a510f69db6ac897b84a1d62973c365234">rootDepths</a>[i] = i * by;</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac96acf762dd39d5ff20d71788b0ca566"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SoilEvapo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>IRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>awc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L412">412</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                                  {</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> SoilArea;</div>
<div class="line">        <span class="keywordtype">double</span> SoilTemp;</div>
<div class="line">        <span class="keywordtype">double</span> Up; <span class="comment">/*Maximum Dimensionless Uptake Rate */</span></div>
<div class="line">        <span class="keywordtype">double</span> TotalRadiation;</div>
<div class="line">        <span class="keywordtype">double</span> BoundaryLayerThickness, DiffCoef;</div>
<div class="line">        <span class="keywordtype">double</span> SoilBoundaryLayer, Ja, rlc;</div>
<div class="line">        <span class="keywordtype">double</span> PhiN, PsycParam, DeltaPVa;</div>
<div class="line">        <span class="keywordtype">double</span> Evaporation = 0.0;  </div>
<div class="line">        <span class="keywordtype">double</span> DdryA, LHV, SlopeFS, SWVC;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> rawc; <span class="comment">/* Relative available water content */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> method = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* some constants */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilClodSize = 0.04;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilReflectance = 0.2;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilTransmission = 0.01;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SpecificHeat = 1010;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> StefanBoltzman = 5.67e-8; <span class="comment">/* Stefan Boltzman Constant */</span></div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Let us assume a simple way of calculating the proportion of the</span></div>
<div class="line"><span class="comment">           soil with direct radiation */</span></div>
<div class="line">        SoilArea = exp(-k * LAI);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For now the temperature of the soil will be the same as the air.</span></div>
<div class="line"><span class="comment">           At a later time this can be made more accurate. I looked at the</span></div>
<div class="line"><span class="comment">           equations for this and the issue is that it is strongly dependent on</span></div>
<div class="line"><span class="comment">           depth. Since the soil model now has a single layer, this cannot be</span></div>
<div class="line"><span class="comment">           implemented correctly at the moment.  */</span></div>
<div class="line"></div>
<div class="line">        SoilTemp = AirTemp;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Let us use an idea of Campbell and Norman. Environmental</span></div>
<div class="line"><span class="comment">           Biophysics. */</span></div>
<div class="line">        <span class="comment">/* If relative available water content is */</span></div>
<div class="line">        rawc = (awc - wiltp)/(fieldc - wiltp);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Page 142 */</span></div>
<div class="line">        <span class="comment">/* Maximum Dimensionless Uptake Rate */</span></div>
<div class="line">        Up = 1 - pow((1 + 1.3 * rawc),-5);  </div>
<div class="line">        <span class="comment">/* This is a useful idea because dry soils evaporate little water when dry*/</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Total Radiation */</span></div>
<div class="line">        <span class="comment">/*&#39; Convert light assuming 1 Âµmol PAR photons = 0.235 J/s Watts*/</span></div>
<div class="line">        <span class="comment">/* At the moment soil evaporation is grossly overestimated. In WIMOVAC</span></div>
<div class="line"><span class="comment">           the light reaching the last layer of leaves is used. Here instead</span></div>
<div class="line"><span class="comment">           of calculating this again, I will for now assume a 10% as a rough</span></div>
<div class="line"><span class="comment">           estimate. Note that I could maybe get this since layIdir and</span></div>
<div class="line"><span class="comment">           layIDiff in sunML are external variables.  Rprintf(&quot;IRad</span></div>
<div class="line"><span class="comment">           %.5f&quot;,layIdir[0],&quot;\n&quot;); Update: 03-13-2009. I tried printing this</span></div>
<div class="line"><span class="comment">           value but it is still too high and will likely overestimate soil</span></div>
<div class="line"><span class="comment">           evaporation. However, this is still a work in progress.</span></div>
<div class="line"><span class="comment">        */</span></div>
<div class="line">        IRad *= rsec; <span class="comment">/* Radiation soil evaporation coefficient */</span> </div>
<div class="line"></div>
<div class="line">        TotalRadiation = IRad * 0.235;</div>
<div class="line"> </div>
<div class="line">        DdryA = <a class="code" href="_aux_bio_cro_8c.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a>(AirTemp) ;</div>
<div class="line">        LHV = <a class="code" href="_aux_bio_cro_8c.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a>(AirTemp) * 1e6 ; </div>
<div class="line"><span class="comment">/* Here LHV is given in MJ kg-1 and this needs to be converted</span></div>
<div class="line"><span class="comment">   to Joules kg-1  */</span></div>
<div class="line">        SlopeFS = <a class="code" href="_aux_bio_cro_8c.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a>(AirTemp) * 1e-3;</div>
<div class="line">        SWVC = <a class="code" href="_aux_bio_cro_8c.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a>(AirTemp) * 1e-3;</div>
<div class="line"></div>
<div class="line">        PsycParam = (DdryA * SpecificHeat) / LHV;</div>
<div class="line">        DeltaPVa = SWVC * (1 - RelH / 100);</div>
<div class="line"></div>
<div class="line">        BoundaryLayerThickness = 4e-3 * sqrt(SoilClodSize / winds); </div>
<div class="line">        DiffCoef = 2.126e-5 * 1.48e-7 * SoilTemp;</div>
<div class="line">        SoilBoundaryLayer = DiffCoef / BoundaryLayerThickness;</div>
<div class="line"></div>
<div class="line">        Ja = 2 * TotalRadiation * ((1 - SoilReflectance - SoilTransmission) / (1 - SoilTransmission));</div>
<div class="line"></div>
<div class="line">        rlc = 4 * StefanBoltzman * pow((273 + SoilTemp),3) * 0.005;</div>
<div class="line"><span class="comment">/* the last term should be the difference between air temperature and</span></div>
<div class="line"><span class="comment">   soil. This is not actually calculated at the moment. Since this is</span></div>
<div class="line"><span class="comment">   mostly relevant to the first soil layer where the temperatures are</span></div>
<div class="line"><span class="comment">   similar. I will leave it like this for now. */</span></div>
<div class="line"></div>
<div class="line">        PhiN = Ja - rlc; <span class="comment">/* Calculate the net radiation balance*/</span></div>
<div class="line">        <span class="keywordflow">if</span>(PhiN &lt; 0) PhiN = 1e-7;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Priestly-Taylor */</span></div>
<div class="line">        <span class="keywordflow">if</span>(method == 0){</div>
<div class="line">                Evaporation = 1.26 * (SlopeFS * PhiN) / (LHV * (SlopeFS + PsycParam));</div>
<div class="line">        }<span class="keywordflow">else</span>{</div>
<div class="line">                <span class="comment">/* Penman-Monteith */</span></div>
<div class="line">                Evaporation = (SlopeFS * PhiN + LHV * PsycParam * SoilBoundaryLayer * DeltaPVa) / (LHV * (SlopeFS + PsycParam));</div>
<div class="line">        }</div>
<div class="line"><span class="comment">/*  Report back the soil evaporation rate in Units mmoles/m2/s */</span></div>
<div class="line"><span class="comment">/*     Evaporation = Evaporation * 1000:   &#39; Convert Kg H20/m2/s to g H20/m2/s */</span></div>
<div class="line"><span class="comment">/*     Evaporation = Evaporation / 18:     &#39; Convert g H20/m2/s to moles H20/m2/s */</span></div>
<div class="line"><span class="comment">/*     Evaporation = Evaporation * 1000:   &#39; Convert moles H20/m2/s to mmoles H20/m2/s */</span></div>
<div class="line">    </div>
<div class="line"><span class="comment">/*     If Evaporation &lt;= 0 Then Evaporation = 0.00001: </span></div>
<div class="line"><span class="comment">       &#39; Prevent any odd looking values which might get through at very low light levels */</span></div>
<div class="line"></div>
<div class="line">        Evaporation *= 1e6/18;</div>
<div class="line">        <span class="comment">/* Adding the area dependence and the effect of drying */</span></div>
<div class="line">        <span class="comment">/* Converting from m2 to ha (times 1e4) */</span></div>
<div class="line">        <span class="comment">/* Converting to hour */</span></div>
<div class="line">        Evaporation *= SoilArea * Up * cf2; </div>
<div class="line">        <span class="keywordflow">if</span>(Evaporation &lt; 0) Evaporation = 1e-6;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(Evaporation);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5537e2a57efaaf41b401666bb9e22062"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a> soilML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoil_text__str.html">soilText_str</a>&#160;</td>
          <td class="paramname"><em>soTexS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>IRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsdf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L804">804</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                                                                                                                                                                                                                                                                                                  {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrd__str.html">rd_str</a> <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structseq_r_d__str.html">seqRD_str</a> <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> tmp;</div>
<div class="line">        <span class="comment">/* Constant */</span></div>
<div class="line">        <span class="comment">/* const double G = 6.67428e-11;  m3 / (kg * s-2)  ##  http://en.wikipedia.org/wiki/Gravitational_constant */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> g = 9.8; <span class="comment">/* m / s-2  ##  http://en.wikipedia.org/wiki/Standard_gravity */</span></div>
<div class="line">        <span class="comment">/* Variables */</span></div>
<div class="line">        <span class="keywordtype">double</span> waterIn, oldWaterIn = 0.0;</div>
<div class="line"><span class="comment">/* Here is a convention aw is available water in volume and awc</span></div>
<div class="line"><span class="comment">   is available water content as a fraction of the soil section being investigated.</span></div>
<div class="line"><span class="comment">   paw is plant available water aw - wiltp */</span></div>
<div class="line">        <span class="keywordtype">double</span> aw, paw, awc, awc2, Newpawha;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a> = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf = 0.0, phi10;</div>
<div class="line">        <span class="keywordtype">double</span> wsPhotoCol = 0.0, wsSpleafCol = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> layerDepth;</div>
<div class="line">        <span class="keywordtype">double</span> diffw;</div>
<div class="line">        <span class="keywordtype">double</span> rootATdepth, rootDepth;</div>
<div class="line">        <span class="keywordtype">double</span> EvapoTra = 0.0, oldEvapoTra = 0.0, Sevap = 0.0, Ctransp = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> psim1 = 0.0, psim2 = 0.0, K_psim = 0.0, J_w = 0.0, dPsim = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> theta_s; <span class="comment">/* This is the saturated soil water content. Larger than FieldC.*/</span></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">int</span> j = layers - 1; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Specify the soil type */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(fieldc &lt; 0){</div>
<div class="line">                fieldc = soTexS.<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(wiltp &lt; 0){</div>
<div class="line">                wiltp = soTexS.<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        theta_s = soTexS.<a class="code" href="structsoil_text__str.html#ac769b10536dd94d3652ad1cbf8d58482">satur</a>;</div>
<div class="line">        <span class="comment">/* rooting depth */</span></div>
<div class="line">        <span class="comment">/* Crude empirical relationship between root biomass and rooting depth*/</span></div>
<div class="line">        rootDepth = rootDB * rsdf;</div>
<div class="line">        <span class="keywordflow">if</span>(rootDepth &gt; soildepth) rootDepth = soildepth;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a> = <a class="code" href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a>(rootDepth,layers);</div>
<div class="line">        <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a> = <a class="code" href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a>(layers,rootDepth,&amp;depths[0],rfl);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line">        waterIn = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(j=0,i=layers-1;j&lt;layers;j++,i--){</div>
<div class="line">        <span class="comment">/* for(i=0;i&lt;layers;i++){ */</span></div>
<div class="line">                <span class="comment">/* It decreases because I increase the water content due to precipitation in the last layer first*/</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">/* This supports unequal depths. */</span></div>
<div class="line">                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line">                        layerDepth = depths[1];</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        layerDepth = depths[i] - depths[i-1];</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(hydrDist &gt; 0){</div>
<div class="line">                        <span class="comment">/* For this section see Campbell and Norman &quot;Environmental BioPhysics&quot; Chapter 9*/</span></div>
<div class="line">                        <span class="comment">/* First compute the matric potential */</span></div>
<div class="line">                        psim1 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of current layer */</span></div>
<div class="line">                        <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line">                                psim2 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of next layer */</span></div>
<div class="line">                                dPsim = psim1 - psim2;</div>
<div class="line">                                <span class="comment">/* The substraction is from the layer i - (i-1). If this last term is positive then it will move upwards. If it is negative it will move downwards. Presumably this term is almost always positive. */</span></div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                dPsim = 0;</div>
<div class="line">                        }</div>
<div class="line">                        K_psim = soTexS.<a class="code" href="structsoil_text__str.html#aa9437b51e97937d66bd2c90f9a411652">Ks</a> * pow((soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a>/psim1),2+3/soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line">                        J_w = K_psim * (dPsim/layerDepth) - g * K_psim ; <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect*/</span></div>
<div class="line">                        <span class="comment">/* Notice that K_psim is positive because my</span></div>
<div class="line"><span class="comment">                            reference system is reversed */</span></div>
<div class="line">                        <span class="comment">/* This last result should be in kg/(m2 * s)*/</span></div>
<div class="line">                         J_w *= 3600 * 0.9882 * 1e-3 ; <span class="comment">/* This is flow in m3 / (m^2 * hr). */</span></div>
<div class="line">                        <span class="comment">/* Rprintf(&quot;J_w %.10f \n&quot;,J_w);  */</span></div>
<div class="line">                        <span class="keywordflow">if</span>(i == (layers-1) &amp;&amp; J_w &lt; 0){</div>
<div class="line">                                        <span class="comment">/* cws[i] = cws[i] + J_w /</span></div>
<div class="line"><span class="comment">                                         * layerDepth; Although this</span></div>
<div class="line"><span class="comment">                                         * should be done it drains</span></div>
<div class="line"><span class="comment">                                         * the last layer too much.*/</span></div>
<div class="line">                                        drainage += J_w;</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i - 1] =  <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1] +  J_w / layerDepth;</div>
<div class="line">                                }<span class="keywordflow">else</span>{</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &gt; theta_s) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = theta_s; </div>
<div class="line">                <span class="comment">/* if(cws[i+1] &gt; fieldc) cws[i+1] = fieldc; */</span></div>
<div class="line">                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &lt; wiltp) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = wiltp; </div>
<div class="line">                <span class="comment">/* if(cws[i+1] &lt; wiltp) cws[i+1] = wiltp;  */</span></div>
<div class="line"></div>
<div class="line">                aw = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] * layerDepth;</div>
<div class="line"><span class="comment">/* Available water (for this layer) is the current water status times the layer depth */</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(waterIn &gt; 0){</div>
<div class="line">                        <span class="comment">/* There is some rain. Need to add it.*/</span></div>
<div class="line">                        aw += waterIn / layers + oldWaterIn; <span class="comment">/* They are both in meters so it works */</span></div>
<div class="line">                        <span class="comment">/* Adding the same amount to water to each layer */</span></div>
<div class="line">                        <span class="comment">/* In case there is overflow */</span></div>
<div class="line">                        diffw = fieldc * layerDepth - aw;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span>(diffw &lt; 0){</div>
<div class="line">                                <span class="comment">/* This means that precipitation exceeded the capacity of the first layer */</span></div>
<div class="line">                                <span class="comment">/* Save this amount of water for the next layer */</span></div>
<div class="line">                                oldWaterIn = -diffw;</div>
<div class="line">                                aw = fieldc * layerDepth;</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                oldWaterIn = 0.0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Root Biomass */</span></div>
<div class="line">                rootATdepth = rootDB * <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line">                tmp.rootDist[i] = rootATdepth;</div>
<div class="line"><span class="comment">/* Plant available water is only between current water status and permanent wilting point */</span></div>
<div class="line">                <span class="comment">/* Plant available water */</span></div>
<div class="line">                paw = aw - wiltp * layerDepth;</div>
<div class="line">                <span class="keywordflow">if</span>(paw &lt; 0) paw = 0; </div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line">                        <span class="comment">/* Only the first layer is affected by soil evaporation */</span></div>
<div class="line">                        awc2 = aw / layerDepth;</div>
<div class="line">                        <span class="comment">/* SoilEvapo function needs soil water content  */</span></div>
<div class="line">                        Sevap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI,k,AirTemp,IRad,awc2,fieldc,wiltp,winds,RelH,rsec);</div>
<div class="line">                        <span class="comment">/* I assume that crop transpiration is distributed simlarly to</span></div>
<div class="line"><span class="comment">                           root density.  In other words the crop takes up water proportionally</span></div>
<div class="line"><span class="comment">                           to the amount of root in each respective layer.*/</span></div>
<div class="line">                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[0];</div>
<div class="line">                        EvapoTra = Ctransp + Sevap;</div>
<div class="line">                        Newpawha = (paw * 1e4) - EvapoTra / 0.9982; <span class="comment">/* See the watstr function for this last number 0.9882 */</span></div>
<div class="line">                        <span class="comment">/* The first term in the rhs (paw * 1e4) is the m3 of water available in this layer.</span></div>
<div class="line"><span class="comment">                           EvapoTra is the Mg H2O ha-1 of transpired and evaporated water. 1/0.9882 converts from Mg to m3 */</span></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line">                        EvapoTra = Ctransp;</div>
<div class="line">                        Newpawha = (paw * 1e4) - (EvapoTra + oldEvapoTra);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(Newpawha &lt; 0){</div>
<div class="line"><span class="comment">/* If the Demand is not satisfied by this layer. This will be stored and added to subsequent layers*/</span></div>
<div class="line">                        oldEvapoTra = -Newpawha;</div>
<div class="line">                         aw = wiltp * layerDepth; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                paw = Newpawha / 1e4 ;</div>
<div class="line">                awc = paw / layerDepth + wiltp;   </div>
<div class="line"></div>
<div class="line"><span class="comment">/* This might look like a weird place to populate the structure, but is more convenient*/</span></div>
<div class="line">                tmp.cws[i] = awc;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 0){</div>
<div class="line">                        slp = 1/(fieldc - wiltp);</div>
<div class="line">                        intcpt = 1 - fieldc * slp;</div>
<div class="line">                        wsPhoto = slp * awc + intcpt ;</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line">                        phi10 = (fieldc + wiltp)/2;</div>
<div class="line">                        wsPhoto = 1/(1 + exp((phi10 - awc)/ phi1));</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line">                        slp = (1 - wiltp)/(fieldc - wiltp);</div>
<div class="line">                        intcpt = 1 - fieldc * slp;</div>
<div class="line">                        theta = slp * awc + intcpt ;</div>
<div class="line">                        wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line">                        wsPhoto = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line">                        wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"></div>
<div class="line">                wsPhotoCol += wsPhoto;</div>
<div class="line"></div>
<div class="line">                wsSpleaf = pow(awc,phi2) * 1/pow(fieldc,phi2); </div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line">                        wsSpleaf = 1;</div>
<div class="line">                }</div>
<div class="line">                wsSpleafCol += wsSpleaf;</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(waterIn &gt; 0){ </div>
<div class="line">                drainage = waterIn;</div>
<div class="line">                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line">                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line">                Nleach = drainage * 0.1 * (1/24*30) / (18 * (0.2 + 0.7 * soTexS.<a class="code" href="structsoil_text__str.html#a4fcef85764276271df64bd49ff7667fb">sand</a>));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Apparently wsPhoto and wsSpleaf can be greater than 1 */</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsPhoto &gt; 1) wsPhoto = 1;</div>
<div class="line">        <span class="keywordflow">if</span>(wsSpleaf &gt; 1) wsSpleaf = 1;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* returning the structure */</span></div>
<div class="line">        tmp.rcoefPhoto = (wsPhotoCol/layers);</div>
<div class="line">        tmp.drainage = <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a>;</div>
<div class="line">        tmp.Nleach = <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a>;</div>
<div class="line">        tmp.rcoefSpleaf = (wsSpleafCol/layers);</div>
<div class="line">        tmp.SoilEvapo = Sevap;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a72f93049960e067cda6e7291ff1ff21a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoil_text__str.html">soilText_str</a> soilTchoose </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soiltype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1163">1163</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                             {</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* This function is based on Campbell and Norman.</span></div>
<div class="line"><span class="comment">           Introduction to Environmental Biophysics. pg 130. */</span></div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> tmp;</div>
<div class="line"></div>
<div class="line">        tmp.<a class="code" href="structsoil_text__str.html#ae79461a167b7ed357bb1ef0c89128b5c">silt</a> = 0;</div>
<div class="line">        tmp.clay = 0;</div>
<div class="line">        tmp.sand = 0;</div>
<div class="line">        tmp.air_entry = 0;</div>
<div class="line">        tmp.b = 0;</div>
<div class="line">        tmp.Ks = 0;</div>
<div class="line">        tmp.satur = 0;</div>
<div class="line">        tmp.fieldc = 0;</div>
<div class="line">        tmp.wiltp = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 0){</div>
<div class="line">        <span class="comment">/* sand soil */</span></div>
<div class="line">        tmp.silt = 0.05;</div>
<div class="line">        tmp.clay = 0.03;</div>
<div class="line">        tmp.sand = 0.92;</div>
<div class="line">        tmp.air_entry = -0.7;</div>
<div class="line">        tmp.b = 1.7;</div>
<div class="line">        tmp.Ks = 5.8e-3;</div>
<div class="line">        tmp.satur = 0.87;</div>
<div class="line">        tmp.fieldc = 0.09;</div>
<div class="line">        tmp.wiltp = 0.03;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 1){</div>
<div class="line">        <span class="comment">/* loamy sand */</span></div>
<div class="line">        tmp.silt = 0.12;</div>
<div class="line">        tmp.clay = 0.07;</div>
<div class="line">        tmp.sand = 0.81;</div>
<div class="line">        tmp.air_entry = -0.9;</div>
<div class="line">        tmp.b = 2.1;</div>
<div class="line">        tmp.Ks = 1.7e-3;</div>
<div class="line">        tmp.satur = 0.72;</div>
<div class="line">        tmp.fieldc = 0.13;</div>
<div class="line">        tmp.wiltp = 0.06;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 2){</div>
<div class="line">        <span class="comment">/* sandy loam */</span></div>
<div class="line">        tmp.silt = 0.25;</div>
<div class="line">        tmp.clay = 0.10;</div>
<div class="line">        tmp.sand = 0.65;</div>
<div class="line">        tmp.air_entry = -1.5;</div>
<div class="line">        tmp.b = 3.1;</div>
<div class="line">        tmp.Ks = 7.2e-4;</div>
<div class="line">        tmp.satur = 0.57;</div>
<div class="line">        tmp.fieldc = 0.21;</div>
<div class="line">        tmp.wiltp = 0.10;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 3){</div>
<div class="line">        <span class="comment">/* loam */</span></div>
<div class="line">        tmp.silt = 0.40;</div>
<div class="line">        tmp.clay = 0.18;</div>
<div class="line">        tmp.sand = 0.52;</div>
<div class="line">        tmp.air_entry = -1.1;</div>
<div class="line">        tmp.b = 4.5;</div>
<div class="line">        tmp.Ks = 3.7e-4;</div>
<div class="line">        tmp.satur = 0.57;</div>
<div class="line">        tmp.fieldc = 0.27;</div>
<div class="line">        tmp.wiltp = 0.12;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 4){</div>
<div class="line">        <span class="comment">/* silt loam */</span></div>
<div class="line">        tmp.silt = 0.65;</div>
<div class="line">        tmp.clay = 0.15;</div>
<div class="line">        tmp.sand = 0.20;</div>
<div class="line">        tmp.air_entry = -2.1;</div>
<div class="line">        tmp.b = 4.7;</div>
<div class="line">        tmp.Ks = 1.9e-4;</div>
<div class="line">        tmp.satur = 0.59;</div>
<div class="line">        tmp.fieldc = 0.33;</div>
<div class="line">        tmp.wiltp = 0.13;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 5){</div>
<div class="line">        <span class="comment">/* sandy clay loam */</span></div>
<div class="line">        tmp.silt = 0.13;</div>
<div class="line">        tmp.clay = 0.27;</div>
<div class="line">        tmp.sand = 0.60;</div>
<div class="line">        tmp.air_entry = -2.8;</div>
<div class="line">        tmp.b = 4;</div>
<div class="line">        tmp.Ks = 1.2e-4;</div>
<div class="line">        tmp.satur = 0.48;</div>
<div class="line">        tmp.fieldc = 0.26;</div>
<div class="line">        tmp.wiltp = 0.15;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 6){</div>
<div class="line">        <span class="comment">/* clay loam */</span></div>
<div class="line">        tmp.silt = 0.34;</div>
<div class="line">        tmp.clay = 0.34;</div>
<div class="line">        tmp.sand = 0.32;</div>
<div class="line">        tmp.air_entry = -2.6;</div>
<div class="line">        tmp.b = 5.2;</div>
<div class="line">        tmp.Ks = 6.4e-5;</div>
<div class="line">        tmp.satur = 0.52;</div>
<div class="line">        tmp.fieldc = 0.32;</div>
<div class="line">        tmp.wiltp = 0.20;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 7){</div>
<div class="line">        <span class="comment">/* silty clay loam */</span></div>
<div class="line">        tmp.silt = 0.58;</div>
<div class="line">        tmp.clay = 0.33;</div>
<div class="line">        tmp.sand = 0.09;</div>
<div class="line">        tmp.air_entry = -3.3;</div>
<div class="line">        tmp.b = 6.6;</div>
<div class="line">        tmp.Ks = 4.2e-5;</div>
<div class="line">        tmp.satur = 0.52;</div>
<div class="line">        tmp.fieldc = 0.37;</div>
<div class="line">        tmp.wiltp = 0.21; <span class="comment">/* Correction from the book from here http://www.public.iastate.edu/~bkh/teaching/505/norman_book_corrections.pdf */</span></div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 8){</div>
<div class="line">        <span class="comment">/* sandy clay */</span></div>
<div class="line">        tmp.silt = 0.07;</div>
<div class="line">        tmp.clay = 0.40;</div>
<div class="line">        tmp.sand = 0.53;</div>
<div class="line">        tmp.air_entry = -2.9;</div>
<div class="line">        tmp.b = 6;</div>
<div class="line">        tmp.Ks = 3.3e-5;</div>
<div class="line">        tmp.satur = 0.51;</div>
<div class="line">        tmp.fieldc = 0.34;</div>
<div class="line">        tmp.wiltp = 0.24;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 9){</div>
<div class="line">        <span class="comment">/* silty clay */</span></div>
<div class="line">        tmp.silt = 0.45;</div>
<div class="line">        tmp.clay = 0.45;</div>
<div class="line">        tmp.sand = 0.10;</div>
<div class="line">        tmp.air_entry = -3.4;</div>
<div class="line">        tmp.b = 7.9;</div>
<div class="line">        tmp.Ks = 2.5e-5;</div>
<div class="line">        tmp.satur = 0.52;</div>
<div class="line">        tmp.fieldc = 0.39;</div>
<div class="line">        tmp.wiltp = 0.25;</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(soiltype == 10){</div>
<div class="line">        <span class="comment">/* clay */</span></div>
<div class="line">        tmp.silt = 0.20;</div>
<div class="line">        tmp.clay = 0.60;</div>
<div class="line">        tmp.sand = 0.20;</div>
<div class="line">        tmp.air_entry = -3.7;</div>
<div class="line">        tmp.b = 7.6;</div>
<div class="line">        tmp.Ks = 1.7e-5;</div>
<div class="line">        tmp.satur = 0.53;</div>
<div class="line">        tmp.fieldc = 0.4;</div>
<div class="line">        tmp.wiltp = 0.27;</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb415c4c261f9fc0140240ad46007c87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sunML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosTheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L74">74</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>, <a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>, <a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>, <a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>, <a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>, <a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[], <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[], <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[], <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[], <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[], <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[];</div>
<div class="line">        <span class="keywordtype">double</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> k0, k1, k;</div>
<div class="line">        <span class="keywordtype">double</span> LAIi, CumLAI;</div>
<div class="line">        <span class="keywordtype">double</span> Isolar, Idiffuse, Ibeam, Iscat, Itotal,alphascatter;</div>
<div class="line">        <span class="keywordtype">double</span> Ls, Ld;</div>
<div class="line">        <span class="keywordtype">double</span> Fsun, Fshade;</div>
<div class="line">        alphascatter=0.8;</div>
<div class="line">        k0 = sqrt(pow(chil ,2) + pow(tan(acos(cosTheta)),2));</div>
<div class="line">        k1 = chil + 1.744*pow((chil+1.183),-0.733);</div>
<div class="line">        k = k0/k1;</div>
<div class="line">        <span class="keywordflow">if</span>(k&lt;0)</div>
<div class="line">                k = -k;</div>
<div class="line"></div>
<div class="line">        LAIi = LAI / nlayers;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                CumLAI = LAIi * (i+0.5);</div>
<div class="line">                </div>
<div class="line">                Ibeam=Idir*cosTheta;</div>
<div class="line">                Iscat = Ibeam * exp(-k *sqrt(alphascatter)* CumLAI)-Ibeam * exp(-k * CumLAI);</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                Isolar = Ibeam*k;</div>
<div class="line">                Idiffuse = Idiff * exp(-kd * CumLAI) + Iscat;</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                Ls = (1-exp(-k*LAIi))*exp(-k*CumLAI)/k;</div>
<div class="line">                Ld=LAIi-Ls;</div>
<div class="line"></div>
<div class="line">                Fsun=Ls/(Ls+Ld);</div>
<div class="line">                Fshade=Ld/(Ls+Ld);</div>
<div class="line">                <span class="comment">/*fraction intercepted*/</span></div>
<div class="line">                Itotal =(Fsun*Isolar + Idiffuse) * (1-exp(-k*LAIi))/k;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* collecting the results */</span></div>
<div class="line">                layIdir[sp1++] = Isolar + Idiffuse;</div>
<div class="line">                layIdiff[sp2++] = Idiffuse;</div>
<div class="line">                layItotal[sp3++] = Itotal;</div>
<div class="line">                layFsun[sp4++] = Fsun;</div>
<div class="line">                layFshade[sp5++] = Fshade;</div>
<div class="line">                layHeight[sp6++] = CumLAI/heightf;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aef4a29370ba3b33794837905d82f3b86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToDdryA </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L179">179</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> DdryA;</div>
<div class="line">        DdryA = 1.295163636 + -0.004258182 * Temp;</div>
<div class="line">        <span class="keywordflow">return</span>(DdryA);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abea4623ebab0e4ea7d9be5af1fd80344"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToLHV </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L186">186</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> LHV;</div>
<div class="line">        LHV = 2.501 + -0.002372727 * Temp;</div>
<div class="line">        <span class="keywordflow">return</span>(LHV);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd35797ea11e52f0c527d40a9c1c0b7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToSFS </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L193">193</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> SlopeFS;</div>
<div class="line">        SlopeFS = 0.338376068 +  0.011435897 * Temp +  0.001111111 * pow(Temp,2);</div>
<div class="line">        <span class="keywordflow">return</span>(SlopeFS);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b62fa0d37af87f9af219e7b0d56f34d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToSWVC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L200">200</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> SWVC;</div>
<div class="line">        SWVC =  4.90820192 +   0.06387253 * Temp +    0.02745742 * pow(Temp,2);</div>
<div class="line">        <span class="keywordflow">return</span>(SWVC);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8dfc137af141b612fc3cde9b49b0fc5f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structws__str.html">ws_str</a> watstr </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soiltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L670">670</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> tmp;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS;</div>
<div class="line">        <span class="comment">/* Variables */</span></div>
<div class="line">        <span class="keywordtype">double</span> precipM;</div>
<div class="line">        <span class="comment">/* available water and per hectare */</span></div>
<div class="line">        <span class="keywordtype">double</span> aw, naw; </div>
<div class="line">        <span class="keywordtype">double</span> pawha, Newpawha, npaw; <span class="comment">/* new 04-27-2009 */</span></div>
<div class="line">        <span class="keywordtype">double</span> runoff = 0.0, runoff2 = 0.0;</div>
<div class="line">        <span class="comment">/* variable needed for calculation of water stress*/</span></div>
<div class="line">        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf, phi10;</div>
<div class="line">        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line">        <span class="keywordtype">double</span> Nleach = 0.0;</div>
<div class="line">        <span class="comment">/* Nleach is the NO3 leached and Ts is the sand content of the soil*/</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Specify the soil type */</span></div>
<div class="line">        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soiltype);</div>
<div class="line"><span class="comment">/*   Ts = soTexS.sand; */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> &lt; 0){</div>
<div class="line">                <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> = soTexS.fieldc;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a> &lt; 0){</div>
<div class="line">                <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a> = soTexS.wiltp;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line">        precipM = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*    cws is current water status */</span></div>
<div class="line">        <span class="comment">/*    available water */</span></div>
<div class="line"></div>
<div class="line">        aw = precipM + cws;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* if(aw &gt; soTexS.satur){  */</span></div>
<div class="line">        <span class="comment">/*      runoff = aw - soTexS.satur; /\* Here runoff is interpreted as water content exceeding saturation level *\/ */</span></div>
<div class="line">        <span class="comment">/*      /\* Need to convert to units used in the Parton et al 1988 paper. *\/ */</span></div>
<div class="line">        <span class="comment">/*      /\* The data comes in mm/hr and it needs to be in cm/month *\/ */</span></div>
<div class="line">        <span class="comment">/*      runoff2 = runoff * 0.10 * (1/24*30); */</span></div>
<div class="line">        <span class="comment">/*      Nleach = runoff /18 * (0.2 + 0.7 * soTexS.sand); */</span></div>
<div class="line">        <span class="comment">/*      aw = soTexS.satur; */</span></div>
<div class="line">        <span class="comment">/* } */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* These equations are not correct as runoff would only occur when it exceeds</span></div>
<div class="line"><span class="comment">   saturation, but from the point of view of a crop only field capacity matters */</span></div>
<div class="line"><span class="comment">/* I&#39;m not sure about what to do about this */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(aw &gt; <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>){ </div>
<div class="line">                runoff = aw - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>; <span class="comment">/* Here runoff is interpreted as water content exceeding saturation level */</span></div>
<div class="line">                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line">                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line">                runoff2 = runoff * 0.10 * (1/24*30);</div>
<div class="line">                Nleach = runoff /18 * (0.2 + 0.7 * soTexS.sand);</div>
<div class="line">                aw = <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Tipping bucket need to collect it if want to estimate runoff */</span> </div>
<div class="line">        <span class="comment">/* plant available water per hectare (pawha) */</span></div>
<div class="line">        pawha = (aw - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>) * 1e4 * soildepth;</div>
<div class="line">        <span class="comment">/* The density of water is 998.2 kg/m3 at 20 degrees Celsius */</span></div>
<div class="line">        <span class="comment">/* or 0.9882 Mg/m3 */</span></div>
<div class="line">        <span class="comment">/* pawha is plant available water (m3) per hectare */</span></div>
<div class="line">        <span class="comment">/* evapo is demanded water (Mg) per hectare */</span></div>
<div class="line"></div>
<div class="line">        Newpawha = pawha - evapo / 0.9882; <span class="comment">/* New version 04-27-2009 */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  Here both are in m3 of water per ha-1 so this */</span></div>
<div class="line">        <span class="comment">/*  subtraction should be correct */</span></div>
<div class="line">        <span class="comment">/* go back to original units of water in the profile */</span></div>
<div class="line"></div>
<div class="line">        npaw = Newpawha * 1e-4 * (1/soildepth); <span class="comment">/* New 04-27-2009 */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(npaw &lt; 0) npaw = 0.0;</div>
<div class="line"></div>
<div class="line">        naw = npaw + <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Calculating the soil water potential based on equations from Norman and Campbell */</span></div>
<div class="line">        <span class="comment">/* tmp.psim = soTexS.air_entry * pow((naw/soTexS.fieldc*1.1),-soTexS.b) ; */</span></div>
<div class="line">        <span class="comment">/* New version of the soil water potential is based on</span></div>
<div class="line"><span class="comment">         * &quot;Dynamic Simulation of Water Deficit Effects upon Maize</span></div>
<div class="line"><span class="comment">         * Yield&quot; R. F. Grant Agricultural Systems. 33(1990) 13-39. */</span></div>
<div class="line">        tmp.psim = -exp(log(0.033) + ((log(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>) - log(naw))/(log(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>) - log(wiltp)) * (log(1.5) - log(0.033)))) * 1e3; <span class="comment">/* This last term converts from MPa to kPa */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* three different type of equations for modeling the effect of water stress on vmax and leaf area expansion. </span></div>
<div class="line"><span class="comment">           The equation for leaf area expansion is more severe than the one for vmax. */</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 0){ <span class="comment">/* linear */</span></div>
<div class="line">                slp = 1/(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>);</div>
<div class="line">                intcpt = 1 - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> * slp;</div>
<div class="line">                wsPhoto = slp * naw + intcpt ;</div>
<div class="line">        }<span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line">                phi10 = (<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> + <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>)/2;</div>
<div class="line">                wsPhoto = 1/(1 + exp((phi10 - naw)/ phi1));</div>
<div class="line">        }<span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line">                slp = (1 - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>)/(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> - wiltp);</div>
<div class="line">                intcpt = 1 - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> * slp;</div>
<div class="line">                theta = slp * naw + intcpt ;</div>
<div class="line">                wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line">        }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line">                        wsPhoto = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line">                wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"></div>
<div class="line">        wsSpleaf = pow(naw,phi2) * 1/pow(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>,phi2); </div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line">                wsSpleaf = 1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Apparently wsPhoto and wsSpleaf can be greater than 1 */</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsPhoto &gt; 1) wsPhoto = 1;</div>
<div class="line">        <span class="keywordflow">if</span>(wsSpleaf &gt; 1) wsSpleaf = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* returning the structure*/</span></div>
<div class="line">        tmp.rcoefPhoto = wsPhoto;</div>
<div class="line">        tmp.rcoefSpleaf = wsSpleaf;</div>
<div class="line">        tmp.awc = naw;</div>
<div class="line">        tmp.runoff = runoff;</div>
<div class="line">        tmp.Nleach = Nleach;</div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a43b0d68a959084dc4f4dc099c8901107"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WINDprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L128">128</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> k=0.7;</div>
<div class="line">        <span class="keywordtype">double</span> LI, CumLAI;</div>
<div class="line">        <span class="keywordtype">double</span> Wind;</div>
<div class="line"></div>
<div class="line">        LI  = LAI / nlayers;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                CumLAI = LI * (i + 1);</div>
<div class="line">                Wind = WindSpeed * exp(-k * (CumLAI-LI));</div>
<div class="line">                <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>++] = Wind;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_aux_bio_cro_8c.html">AuxBioCro.c</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:25 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
